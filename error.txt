Traceback (most recent call last):
  File "changing_point_detection.py", line 282, in <module>
    execute_all(0,model,3.7,4.0)
  File "changing_point_detection.py", line 272, in execute_all
    loss_per_epochs,all_loss = get_loss(factors,answers,model,criterion,optimizer,picture_name,before_a,after_a)
  File "changing_point_detection.py", line 172, in get_loss
    loss, _ = train_step(factors[start:end], answers[start:end],model,criterion,optimizer)
  File "changing_point_detection.py", line 148, in train_step
    preds = model(factors)              # forwardメソッド実行。
  File "/home/kohei/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "changing_point_detection.py", line 41, in forward
    y = self.l2(h[:, -1])   # y.shape: [25,1]   → [予測結果(batch_size分)]
  File "/home/kohei/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/kohei/.local/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 91, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/kohei/.local/lib/python3.8/site-packages/torch/nn/functional.py", line 1674, in linear
    ret = torch.addmm(bias, input, weight.t())
RuntimeError: size mismatch, m1: [1 x 4], m2: [2 x 1] at /pytorch/aten/src/TH/generic/THTensorMath.cpp:41

If you suspect this is an IPython 7.17.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True

